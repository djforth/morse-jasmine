(function(global,factory){if('function'==typeof define&&define.amd)define(['module','exports','lodash/reject','lodash/forEach','lodash/isNull','lodash/isObject','lodash/map','lodash/isArray','lodash/forIn','lodash/isPlainObject','lodash/isString','lodash/isEmpty','lodash/find','./spy_manager'],factory);else if('undefined'!=typeof exports)factory(module,exports,require('lodash/reject'),require('lodash/forEach'),require('lodash/isNull'),require('lodash/isObject'),require('lodash/map'),require('lodash/isArray'),require('lodash/forIn'),require('lodash/isPlainObject'),require('lodash/isString'),require('lodash/isEmpty'),require('lodash/find'),require('./spy_manager'));else{var mod={exports:{}};factory(mod,mod.exports,global.reject,global.forEach,global.isNull,global.isObject,global.map,global.isArray,global.forIn,global.isPlainObject,global.isString,global.isEmpty,global.find,global.spy_manager),global.stub_inner=mod.exports}})(this,function(module,exports,_reject2,_forEach2,_isNull2,_isObject2,_map2,_isArray2,_forIn2,_isPlainObject2,_isString2,_isEmpty2,_find2,_spy_manager){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getItem(list,title){var obj=(0,_find3.default)(list,function(spy){return spy.title===title});return(0,_isEmpty3.default)(obj)?null:obj}function spyCreator(Module,manager){return function(mod){var title=(0,_isString3.default)(mod)?mod:mod.title,spy=manager.addSpy(mod).getSpy(title);return Module.__Rewire__(title,spy),{title:title,spy:spy}}}function resetSpy(spy){(0,_isPlainObject3.default)(spy)?(0,_forIn3.default)(spy,function(v){v.calls.reset()}):spy.calls.reset()}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=function(Module){var spies=[],_addSpy=spyCreator(Module,spyManager),obj={add:function add(modules){return obj.addSpy(modules)},addSpy:function addSpy(modules){return(0,_isArray3.default)(modules)?(modules=(0,_map3.default)(modules,function(m){return _addSpy(m)}),spies=spies.concat(modules),obj):(((0,_isString3.default)(modules)||(0,_isObject3.default)(modules))&&spies.push(_addSpy(modules)),obj)},get:function get(title){return obj.getSpy(title)},getSpy:function getSpy(title){var obj=getItem(spies,title);return(0,_isNull3.default)(obj)?null:obj.spy},return:function _return(title,mod_obj){var mod=getItem(spies,title);if((0,_isNull3.default)(mod)){var new_spy=mod_obj?{title:title,opts:[mod_obj]}:title;obj.addSpy(new_spy),mod=getItem(spies,title)}return mod=mod.spy,mod_obj&&(mod=mod[mod_obj]),function(func,value){mod.and[func](value)}},returnObj:function returnObj(title){var mod=getItem(spies,title).spy;return function(opts){(0,_forEach3.default)(opts,function(opt){mod[opt.title].and[opt.func](opt.value)})}},revertAll:function revertAll(){(0,_forEach3.default)(spies,function(mod){resetSpy(mod.spy),Module.__ResetDependency__(mod.title)}),spies=[]},revertSpy:function revertSpy(title){var mod=getItem(list,title);return resetSpy(mod.spy),Module.__ResetDependency__(mod.title),spies=(0,_reject3.default)(spies,function(s){return s.title===title}),mod},setSpies:function setSpies(spy_list){(0,_forEach3.default)(spy_list,function(sl){var mod=getItem(spies,sl.title);mod.spy.and[sl.func](sl.value)})}};return obj};var _reject3=_interopRequireDefault(_reject2),_forEach3=_interopRequireDefault(_forEach2),_isNull3=_interopRequireDefault(_isNull2),_isObject3=_interopRequireDefault(_isObject2),_map3=_interopRequireDefault(_map2),_isArray3=_interopRequireDefault(_isArray2),_forIn3=_interopRequireDefault(_forIn2),_isPlainObject3=_interopRequireDefault(_isPlainObject2),_isString3=_interopRequireDefault(_isString2),_isEmpty3=_interopRequireDefault(_isEmpty2),_find3=_interopRequireDefault(_find2),_spy_manager2=_interopRequireDefault(_spy_manager),spyManager=(0,_spy_manager2.default)();module.exports=exports['default']});